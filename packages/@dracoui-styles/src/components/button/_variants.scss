/**
 * Copyright (c) Corinvo, LLC. and its partners and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

@use 'sass:map';
@use 'tokens' as *;
@use '@dracoui/primitives';
@use '../../utilities/disabled-state' as *;
@use '../../utilities/variant-selector' as *;

$alignments: (start: flex-start, center: center, end: flex-end);

$button-variants: (
  'primary': (
    'background': var(--draco-button-primary-background),
    'foreground': var(--draco-button-primary-foreground),
    'border': $button-border-width $button-border-style var(--draco-button-primary-border)
  ),
  'secondary': (
    'background': var(--draco-button-secondary-background),
    'foreground': var(--draco-button-secondary-foreground),
  ),
  'tertiary': (
    'background': var(--draco-button-tertiary-background),
    'foreground': var(--draco-button-tertiary-foreground),
    'border': $button-border-width $button-border-style transparent,
    'border-hover': $button-border-width $button-border-style var(--draco-button-tertiary-border-hovered)
  ),
  'ghost': (
    'background': var(--draco-button-ghost-background),
    'foreground': var(--draco-button-ghost-foreground),
  ),
  'amber': (
    'background': var(--draco-button-amber-background),
    'foreground': var(--draco-button-amber-foreground),
  ),
  'error': (
    'background': var(--draco-button-error-background),
    'foreground': var(--draco-button-error-foreground),
  )
);

.draco-button {
  @each $name, $variant in $button-variants {
    @include variant-selector($name) {
      color: map.get($variant, 'foreground');
      background-color: map.get($variant, 'background');

      // Primary color for specific variants, might be delted later!!
      &:not(:disabled):not([disabled]):not(.mock-disabled) {
        &:hover {
          @if $name == 'tertiary' or $name == 'secondary' {
            color: primitives.$draco-product-color-brand-primary;
          }
        }
      }

      @include disabled-state {
        box-shadow: none;
        cursor: not-allowed;
        border: none !important;
        color: var(--draco-button-#{$name}-text-disabled);
        background-color: var(--draco-button-#{$name}-background-disabled);
        border-color: var(--draco-button-#{$name}-border-disabled);

        transform: none !important;
        will-change: none !important;
      }

      @if map.get($variant, 'border') {
        border: map.get($variant, 'border');
      } @else {
        border: primitives.$draco-border-width-thin solid transparent;
      }

      &:not(:disabled):not([disabled]):not(.mock-disabled) {
        &:hover {
          background-color: var(--draco-button-#{$name}-background-hovered);
          @if map.get($variant, 'border-hover') {
            border: map.get($variant, 'border-hover');
          } @else if map.get($variant, 'border') {
            border: map.get($variant, 'border');
          }
        }

        &:active {
          will-change: transform, box-shadow;
          box-shadow: none;
          transform: translateZ(0) scale(0.96);
          @if map.get($variant, 'border-hover') {
            border: map.get($variant, 'border-hover');
          } @else if map.get($variant, 'border') {
            border: map.get($variant, 'border');
          }
        }
      }

      // Depth effect - right direction (default)
      &.draco-button--depth.draco-button--depth-right {
        box-shadow:
          2px 2px 0px 0px var(--draco-button-#{$name}-shadow),
          3px 3px 0px 0px var(--draco-button-#{$name}-shadow);
        transform: translateZ(0) translate(0, 0);

        &:not(:disabled):not([disabled]):not(.mock-disabled) {
          &:hover {
            transform: translateZ(0) translate(1px, 1px);
            box-shadow:
              1px 1px 0px 0px var(--draco-button-#{$name}-shadow),
              2px 2px 0px 0px var(--draco-button-#{$name}-shadow);
          }

          &:active {
            transform: translateZ(0) translate(2px, 2px);
            box-shadow: 0px 0px 0px 0px var(--draco-button-#{$name}-shadow);
          }
        }
      }

      // Depth effect - center direction
      &.draco-button--depth.draco-button--depth-center {
        box-shadow:
          0px 2px 0px 0px var(--draco-button-#{$name}-shadow),
          0px 3px 0px 0px var(--draco-button-#{$name}-shadow);
        transform: translateZ(0) translate(0, 0);

        &:not(:disabled):not([disabled]):not(.mock-disabled) {
          &:hover {
            transform: translateZ(0) translate(0, 1px);
            box-shadow:
              0px 1px 0px 0px var(--draco-button-#{$name}-shadow),
              0px 2px 0px 0px var(--draco-button-#{$name}-shadow);
          }

          &:active {
            transform: translateZ(0) translate(0, 2px);
            box-shadow: 0px 0px 0px 0px var(--draco-button-#{$name}-shadow);
          }
        }
      }
    }
  }

  // Alignment variants
  @each $name, $value in $alignments {
    &.draco-button--align-#{$name} {
      justify-content: $value;
    }
  }
}